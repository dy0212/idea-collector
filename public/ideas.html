<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì €ì¥ëœ ì•„ì´ë””ì–´ ëª©ë¡</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .card { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 8px; }
    .error { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1>ğŸ“ ì €ì¥ëœ ì•„ì´ë””ì–´ë“¤</h1>
  <div id="ideaList"></div>
  <button onclick="window.history.back()">â¬… ëŒì•„ê°€ê¸°</button>

  <script>
    const API_BASE = window.location.origin;

    async function loadIdeas() {
      const listEl = document.getElementById('ideaList');
      listEl.innerHTML = '';

      try {
        const res = await fetch(`${API_BASE}/ideas`, { credentials: 'include' });
        if (!res.ok) {
          const msg = document.createElement('p');
          msg.className = 'error';
          msg.textContent = 'âš ï¸ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.';
          listEl.appendChild(msg);
          return;
        }

        const ideas = await res.json();
        ideas.reverse().forEach(idea => {
          const card = document.createElement('div');
          card.className = 'card';

          const titleEl = document.createElement('strong');
          titleEl.textContent = idea.title;

          const author = document.createElement('div');
          author.innerHTML = `<small>ì‘ì„±ì: <b>${idea.user?.username || 'ì•Œ ìˆ˜ ì—†ìŒ'}</b></small>`;

          card.appendChild(title);
          card.appendChild(author);

          const dateEl = document.createElement('small');
          dateEl.textContent = new Date(idea.date).toLocaleString();

          const descEl = document.createElement('p');
          descEl.textContent = idea.description;

          card.appendChild(titleEl);
          card.appendChild(document.createElement('br'));
          card.appendChild(dateEl);
          card.appendChild(document.createElement('br'));
          card.appendChild(descEl);

          listEl.appendChild(card);
        });
      } catch (err) {
        console.error('ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', err);
        const errorMsg = document.createElement('p');
        errorMsg.className = 'error';
        errorMsg.textContent = 'ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨. ì„œë²„ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”.';
        listEl.appendChild(errorMsg);
      }
    }

    loadIdeas();
  </script>
</body>
</html>
